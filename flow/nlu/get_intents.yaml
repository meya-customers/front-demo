steps:
  - type: component.nlu.tokenize_text
    text: (@ flow.result )
  - flow_set:
      sentences: (@ flow.result )
      index: 0
      intents:

  - (detect)
  - detect_dialogflow: (@ flow.sentences[flow.index] )
    integration: integration.google.dialogflow
    language: en
    min_confidence: 0.1

  - if: (@ flow.result != "fallback" )
    then:
      jump: add_intent_to_list
    else: next

  - (continue)
  - flow_set:
      index: (@ flow.index + 1 )
  - if: (@ flow.index == flow.sentences | length )
    then:
      jump: end
    else:
      jump: detect

  - (add_intent_to_list)
  - if: (@ flow.intents )
    then:
      jump: append
    else: next
  - flow_set:
      intents:
        - (@ flow.result )
  - jump: continue

  - (append)
  - flow_set:
      intents: (@ flow.intents + [flow.result] )
  - jump: continue

  - (end)
  - end:
      intents: (@ flow.intents )
